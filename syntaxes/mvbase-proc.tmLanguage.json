{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "mvBase PROC",
	"patterns": [
		{ "include": "#labels" },
		{ "include": "#numbers" },
		{ "include": "#strings" },
		{ "include": "#proc-bang" },
		{ "include": "#comments" },
		{ "include": "#commands" }
	],
	"repository": {
		"commands": {
			"patterns": [
				{ "include": "#a-cmd" },
				{ "include": "#call-cmd"},
				{ "include": "#d-cmd" },
				{ "include": "#go-cmd" },
				{ "include": "#h-cmd" },
				{ "include": "#if-cmd" },
				{ "include": "#ih-cmd" },
				{ "include": "#ip-cmd" },
				{ "include": "#is-cmd" },
				{ "include": "#link-cmd" },
				{ "include": "#o-cmd" },
				{ "include": "#p-cmd" },
				{ "include": "#ri-cmd" },
				{ "include": "#s-cmd" },
				{ "include": "#t-cmd" },
				{ "include": "#x-cmd"},
				{ "include": "#nullary-commands" }
		]
		},
		"nullary-commands": {
			"comment": "Nullary Commands",
			"match": "(B|BO|F|IT|RO|SP|SS|STOFF|ST OFF|STON|ST ON)$",
			"captures": {
				"1": { "name": "entity.name.function" }
			}
		},
		"comments": {
			"comment": "Line Comment",
			"match": "^(C.*$)",
			"captures": {
				"1": { "name": "comment.line.mvbase-proc" }
			}
		},
		"labels": {
			"comment": "Numeric Label",
			"match": "^(\\d+)",
			"captures": {
				"1": { "name": "keyword.control.mvbase-proc"}
			}
		},
		"numbers": {
			"comment": "Numeric Constants",
			"match": "(\\d+)",
			"captures": {
				"1": { "name": "constant.numeric.mvbase-proc" }
			}
		},
		"strings": {
			"comment": "Quoted Strings",
			"name": "string.double.mvbase-proc",
			"match": "(\"[^\"\n]+\")",
			"captures": {
				"1": { "name": "string.double.mvbase-proc" }
			}
		},
		"proc-bang": {
			"comment": "mvBase PROC Bang",
			"match": "^(PQ)$",
			"captures": {
				"1": { "name": "constant.language.mvbase-proc" }
			}
		},
		"a-cmd": {
			"comment": "A Command",
			"match": "(A)(\"|')?(\\d+)?(?:[^\\d])?((?<=,)\\d+)?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "constant.character.mvbase-proc" },
				"3": { "name": "variable.parameter.mvbase-proc" },
				"4": { "name": "variable.parameter.mvbase-proc" }
			}
		},
		"call-cmd": {
			"comment": "Call Command ()",
			"match": "[\\[](?:(DICT) )?(\\w+| )(?: (\\w+))?[\\]](?: (\\d+))?",
			"captures": {
				"1": { "name": "storage.type" },
				"2": { "name": "string.unquoted.mvbase-proc" },
				"3": { "name": "variable.parameter.mvbase-proc" },
				"4": { "name": "keyword.control.mvbase-proc" }
			}
		},
		"d-cmd": {
			"comment": "D Command",
			"match": "(D)(\\d+)?(?:[^\\d])?((?<=,)\\d+)?([+])?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "variable.parameter.mvbase-proc" },
				"3": { "name": "variable.other.mvbase-proc" },
				"4": { "name": "constant.character.mvbase-proc" }
			}
		},
		"go-cmd": {
			"comment": "GO/G Command",
			"match": "(GO|G)(?: (\\d+)| (A)(\\d+)?)?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "keyword.control.mvbase-proc" },
				"3": { "name": "entity.name.function" },
				"4": { "name": "variable.parameter.mvbase-proc" }
			}
		},
		"h-cmd": {
			"comment": "H Command",
			"match": "(H)(.*?)(?:(?=[<]+$)|(?=$))(<$)?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "string.unquoted.mvbase-proc"},
				"3": { "name": "constant.character.mvbase-proc" }
			}
		},
		"if-cmd": {
			"comment": "IF Command",
			"match": "(IF)(?: (#)?)(?:(A)(\\d+)?(?:[^\\d]?(?<=,)(\\d+))?|(E)|(S))?(?: (<|>|=|#|\\[|\\])(?: (\\(?[^ ]+\\)?)))?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "constant.character.mvbase-proc" },
				"3": { "name": "entity.name.function" },
				"4": { "name": "variable.parameter.mvbase-proc" },
				"5": { "name": "variable.parameter.mvbase-proc" },
				"6": { "name": "entity.name.function" },
				"7": { "name": "entity.name.function" },
				"8": { "name": "constant.character.mvbase-proc"},
				"9": { "name": "string.unquoted.mvbase-proc" }
			},
			"patterns": [
				{ "include": "#call-cmd"},
				{ "include": "#d-cmd" },
				{ "include": "#go-cmd" },
				{ "include": "#h-cmd" },
				{ "include": "#if-cmd" },
				{ "include": "#ih-cmd" },
				{ "include": "#ip-cmd" },
				{ "include": "#is-cmd" },
				{ "include": "#link-cmd" },
				{ "include": "#o-cmd" },
				{ "include": "#p-cmd" },
				{ "include": "#ri-cmd" },
				{ "include": "#s-cmd" },
				{ "include": "#t-cmd" },
				{ "include": "#x-cmd"},
				{ "include": "#nullary-commands" }
			]
		},
		"ih-cmd": {
			"comment": "IH Command",
			"match": "(IH)(.*$)",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "string.unquoted.mvbase-proc"}
			}
		},
		"ip-cmd": {
			"comment": "IP Command",
			"match": "(IP)(B)?(.)?$",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "variable.parameter.mvbase-proc" },
				"3": { "name": "constant.character.mvbase-proc"}
			}
		},
		"is-cmd": {
			"comment": "IS Command",
			"match": "(IS)(.)?$",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "keyword.other.mvbase-proc"}
			}
		},
		"link-cmd": {
			"comment": "Link Command ()",
			"match": "[(](?:(DICT) )?(\\w+)(?: (\\w+))?[)](?: (\\d+))?",
			"captures": {
				"1": { "name": "storage.type" },
				"2": { "name": "string.unquoted.mvbase-proc" },
				"3": { "name": "variable.parameter.mvbase-proc" },
				"4": { "name": "keyword.control.mvbase-proc" }
			}
		},
		"o-cmd": {
			"comment": "O Command",
			"match": "((?<!G)O)(.*?)(?:(?=[+]+$)|(?=$))([+]$)?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "string.unquoted.mvbase-proc"},
				"3": { "name": "constant.language.mvbase-proc" }
			}
		},
		"p-cmd": {
			"comment": "P Command",
			"match": "(P)(?!Q)(H|P|W|X)?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "variable.parameter.mvbase-proc" }
			}
		},
		"ri-cmd": {
			"comment": "RI Command",
			"match": "(RI)(\\d+)?",
			"captures": {
				"1":{ "name": "entity.name.function" },
				"2": { "name": "variable.parameter.mvbase-proc" }
			}
		},
		"s-cmd": {
			"comment": "S Command",
			"match": "(S)(\\d+)",
			"captures": {
				"1":{ "name": "entity.name.function" },
				"2": { "name": "variable.parameter.mvbase-proc" }
			}
		},
		"t-cmd": {
			"comment": "T Command",
			"match": "(T)",
			"captures": {
				"1": { "name": "string.unquoted.mvbase-proc" }
			}
		},
		"x-cmd": {
			"comment": "X Command",
			"match": "(X)(.+)?",
			"captures": {
				"1": { "name": "entity.name.function" },
				"2": { "name": "string.unquoted.mvbase-proc"}
			}
		}
	},
	"scopeName": "source.mvbase-proc"
}